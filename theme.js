(()=>{"use strict";var n={2:function(n,t,e){var o=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function u(n){try{r(o.next(n))}catch(n){s(n)}}function c(n){try{r(o.throw(n))}catch(n){s(n)}}function r(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(u,c)}r((o=o.apply(n,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.t=function(){return o(this,void 0,void 0,(function*(){(0,m.o)(),(0,v.i)(),(0,g.u)(),(0,h.l)(),(0,a.m)(),(0,b._)(),yield(0,a.v)(),r.h.p||(yield(0,s.k)(),yield(0,w.M)("initials"),(0,w.S)()),L(),(0,d.C)(),(0,h.P)(),y.start(document,"mouseup"),x.start(document,"dragend"),k.start(document,"keyup",!0),M.start(window,"focus"),M.start(window,"blur"),S.start(document,"selectionchange"),C.observe(document.body,c.A),I.start(_.I,"change"),a.$.start(document,"mouseup"),a.O.start(document,"mouseup"),r.L.j||(yield(0,u.B)(".layout__center")),r.h.p||(P.observe(r.L.j),A.observe(document.body))}))},t.T=function(){return o(this,arguments,void 0,(function*(n=!0){n&&(r.h.p||(yield(0,w.R)()),(0,d.N)(),(0,p.F)(),(0,l.D)(),(0,d.H)(),(0,b.V)(),(0,f.J)(),(0,h.U)(),(0,h.W)(),(0,m.K)(),(0,v.Y)(),(0,g.q)(),document.body.classList.remove("body-asri--fullscreen","asri-tfp","asri-tfp-acrylic","asri-tfp-progressive"),(0,a.G)()),y.remove(document,"mouseup"),x.remove(document,"dragend"),k.remove(document,"keyup",!0),M.remove(window,"focus"),M.remove(window,"blur"),S.remove(document,"selectionchange"),C.disconnect(),I.remove(_.I,"change"),a.$.remove(document,"mouseup"),a.O.remove(document,"mouseup"),r.h.p||(P.disconnect(),A.disconnect())}))};const i=e(796),s=e(937),u=e(629),c=e(766),r=e(49),l=e(12),a=e(553),d=e(818),m=e(261),f=e(54),_=e(288),b=e(863),v=e(832),p=e(844),h=e(414),w=e(376),g=e(130),y=new i.X(j),x=new i.X(j),k=new i.X(j),M=new i.X((function(n){(0,s.k)().then((()=>{L(),!r.h.Z&&a.followSysAccentColor&&r.h.nn&&(0,a.tn)()}))})),S=new i.X(f.en),C=new c.sn((function(n,t){return o(this,void 0,void 0,(function*(){var t,e;for(let o of n){const n=o.target;if(n.classList.contains("body--blur"))return;if(n.classList.contains("b3-list-item--focus")&&(0,p.un)(),n.classList.contains("item--focus")){const e=null!==(t=n.getAttribute("data-id"))&&void 0!==t?t:void 0;(0,b._)(e)}if(n.classList.contains("layout__wnd--active")){const t=n.querySelector(".layout__center .layout-tab-container>[data-id]:not(.fn__none)");if(!t)return;const o=null!==(e=t.getAttribute("data-id"))&&void 0!==e?e:void 0;(0,b._)(o)}}}))})),P=new c.cn((function(n,t){(0,w.rn)(0,$,s.ln).then(w.an),(0,l.dn)(),(0,h.mn)()})),A=new c.cn((function(n,t){for(let t of n){$=!0,B();const{inlineSize:n}=t.contentBoxSize[0];if(t.target instanceof HTMLElement){if(!t.target.dataset.fn){t.target.dataset.fn=n+"";continue}const e=n-parseFloat(t.target.dataset.fn);t.target.dataset.fn=n+"",O=e}}})),I=new i.X((function(n){(0,_._n)(600,(()=>{}),200)}));let $=!1,O=0;function j(n){(0,a.bn)(n),(0,l.vn)(n),L(n),(0,_.pn)(n)}function L(n){return o(this,void 0,void 0,(function*(){function t(){setTimeout((()=>o(this,void 0,void 0,(function*(){(0,d.hn)(),(0,h.mn)(),(0,h.l)(),yield(0,s.k)(),(0,l.wn)(),(0,d.C)(),(0,h.P)(),!r.h.Z&&a.followSysAccentColor&&r.h.nn&&(0,a.tn)()}))),0)}n?(n.type.startsWith("mouse")||n.type.startsWith("drag")||n instanceof KeyboardEvent&&("Control"===n.key||"Alt"===n.key||"Shift"===n.key||"Meta"===n.key))&&(t(),setTimeout((()=>{(0,w.gn)(),(0,w.rn)(0,!1,s.ln).then(w.an)}),0)):(t(),(0,w.rn)().then(w.an))}))}const B=(0,u.yn)((()=>{$=!1,(0,w.xn)(),(0,s.kn)(),s.ln||(0,w.gn)(),(0,w.rn)(O,$,s.ln).then(w.an),O=0}),200)},12:function(n,t,e){var o=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function u(n){try{r(o.next(n))}catch(n){s(n)}}function c(n){try{r(o.throw(n))}catch(n){s(n)}}function r(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(u,c)}r((o=o.apply(n,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.dn=void 0,t.wn=d,t.vn=function(n){return o(this,void 0,void 0,(function*(){var t,e,u;if("mouseup"!==n.type)return;a||(a=yield(0,c.v)());const d=n.target,m=d.closest(".ariaLabel");if(!m)return;const f=m.dataset.type,_=d.closest(".protyle-title__icon")||"doc"===m.dataset.type?"doc":void 0,b=r.includes(f)?f:_;if(!b)return;const v="doc"===b?null!==(t=m.parentElement.dataset.nodeId)&&void 0!==t?t:null===(u=null===(e=m.closest(".protyle"))||void 0===e?void 0:e.querySelector(".protyle-title"))||void 0===u?void 0:u.dataset.nodeId:m.dataset.nodeId;l=yield(0,s.B)("#commonMenu:not(.fn__none)"),function(n,t){o(this,void 0,void 0,(function*(){const e="doc"===n;!function(n){o(this,void 0,void 0,(function*(){var t,e;if(!l||document.getElementById("afwdMenuItem-clear"))return;const o=l.lastChild,i=document.createElement("button");i.className="b3-menu__item";const s=document.createElement("button");s.className="b3-menu__separator";const u=`\n        <button class="b3-menu__item b3-menu__item--custom" id="afwdMenuItem-on">\n            <svg class="b3-menu__icon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">\n            <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m9 12l2 2l4-4"/></g>\n            </svg>\n            <span class="b3-menu__label">${a["afwdMenuItem-on"]}</span>\n        </button>\n        <button class="b3-menu__item b3-menu__item--custom" id="afwdMenuItem-off">\n            <svg class="b3-menu__icon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">\n            <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m15 9l-6 6m0-6l6 6"/></g>\n            </svg>\n            <span class="b3-menu__label">${a["afwdMenuItem-off"]}</span>\n        </button>\n    `,c=`\n        <button class="b3-menu__item b3-menu__item--custom" id="afwdMenuItem-all">\n            <span class="b3-menu__label">\n                <div class="fn__flex">\n                    <svg class="b3-menu__icon" style=""></svg>\n                    <span>${a["afwdMenuItem-all"]}</span>\n                    <span class="fn__space fn__flex-1"></span>\n                    <input type="checkbox" class="b3-switch fn__flex-center">\n                </div>\n            </span>\n        </button>\n        <button class="b3-menu__item b3-menu__item--custom" id="afwdMenuItem-db">\n            <span class="b3-menu__label">\n                <div class="fn__flex">\n                    <svg class="b3-menu__icon" style=""><use xlink:href="#iconDatabase"></use></svg>\n                    <span>${a["afwdMenuItem-db"]}</span>\n                    <span class="fn__space fn__flex-1"></span>\n                    <input type="checkbox" class="b3-switch fn__flex-center">\n                </div>\n            </span>\n        </button>\n        <button class="b3-menu__item b3-menu__item--custom" id="afwdMenuItem-t">\n            <span class="b3-menu__label">\n                <div class="fn__flex">\n                    <svg class="b3-menu__icon" style=""><use xlink:href="#iconTable"></use></svg>\n                    <span>${a["afwdMenuItem-t"]}</span>\n                    <span class="fn__space fn__flex-1"></span>\n                    <input type="checkbox" class="b3-switch fn__flex-center">\n                </div>\n            </span>\n        </button>\n        <button class="b3-menu__item b3-menu__item--custom" id="afwdMenuItem-p">\n            <span class="b3-menu__label">\n                <div class="fn__flex">\n                    <svg class="b3-menu__icon"><use xlink:href="#iconImage"></use></svg>\n                    <span>${a["afwdMenuItem-p"]}</span>\n                    <span class="fn__space fn__flex-1"></span>\n                    <input type="checkbox" class="b3-switch fn__flex-center">\n                </div>\n            </span>\n        </button>\n        <button class="b3-menu__item b3-menu__item--custom" id="afwdMenuItem-iframe">\n            <span class="b3-menu__label">\n                <div class="fn__flex">\n                    <svg class="b3-menu__icon"><use xlink:href="#iconHTML5"></use></svg>\n                    <span>${a["afwdMenuItem-iframe"]}</span>\n                    <span class="fn__space fn__flex-1"></span>\n                    <input type="checkbox" class="b3-switch fn__flex-center">\n                </div>\n            </span>\n        </button>\n        <button class="b3-menu__item b3-menu__item--custom" id="afwdMenuItem-sb">\n            <span class="b3-menu__label">\n                <div class="fn__flex">\n                    <svg class="b3-menu__icon"><use xlink:href="#iconSuper"></use></svg>\n                    <span>${a["afwdMenuItem-sb"]}</span>\n                    <span class="fn__space fn__flex-1"></span>\n                    <input type="checkbox" class="b3-switch fn__flex-center">\n                </div>\n            </span>\n        </button>\n    `,r=`\n        <svg class="b3-menu__icon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 18 18">\n            <path fill="currentColor" d="m15.503 15.003l-.735.71a.75.75 0 1 0 1.042 1.078l1.886-1.82a1 1 0 0 0 0-1.44l-1.886-1.82a.75.75 0 0 0-1.042 1.079l.739.713H12.75a.75.75 0 0 0 0 1.5zM15 3a2 2 0 0 1 2 2v4.25a.75.75 0 0 1-1.5 0V5a.5.5 0 0 0-.5-.5H5a.5.5 0 0 0-.5.5v4.25a.75.75 0 0 1-1.5 0V5a2 2 0 0 1 2-2zM5.234 15.712l-.735-.71h2.752a.75.75 0 1 0 0-1.5H4.495l.739-.713a.75.75 0 0 0-1.042-1.078l-1.886 1.82a1 1 0 0 0 0 1.44l1.886 1.82a.75.75 0 0 0 1.042-1.079"/>\n        </svg>\n        <span class="b3-menu__label">${a.afwdDocMenuLabel}</span>\n        <svg class="b3-menu__icon b3-menu__icon--small">\n            <use xlink:href="#iconRight"></use>\n        </svg>\n        <div class="b3-menu__submenu">\n            <div class="b3-menu__items">\n                ${"doc"===n?c:u}\n                <button class="b3-menu__separator"></button>\n                <button class="b3-menu__item" id="afwdMenuItem-clear">\n                    <svg class="b3-menu__icon " style=""><use xlink:href="#iconTrashcan"></use></svg>\n                    <span class="b3-menu__label">${a["afwdMenuItem-clear"]}\n                    </span>\n                </button>\n            </div>\n        </div>\n    `;if(i.innerHTML=r,o.insertBefore(i,null===(t=o.lastChild)||void 0===t?void 0:t.previousSibling),o.insertBefore(s,i),"doc"!==n)return;const d=document.createElement("button");d.className="b3-menu__item";const m=`\n        <svg class="b3-menu__icon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 22 22">\n            <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 5h-3m-5 0h5m-5 0v10m0-10h-1c-1.667 0-5 1-5 5s3.333 5 5 5h1m0 4v-4m5 4V5"/>\n        </svg>\n        <span class="b3-menu__label">${a.tdirDocMenuLabel}</span>\n        <svg class="b3-menu__icon b3-menu__icon--small">\n            <use xlink:href="#iconRight"></use>\n        </svg>\n        <div class="b3-menu__submenu">\n            <div class="b3-menu__items">\n                <button class="b3-menu__item b3-menu__item--custom" id="tdirMenuItem-ltr">\n                    <svg class="b3-menu__icon " style=""><use xlink:href="#iconLtr"></use></svg>\n                    <span class="b3-menu__label">${a["tdirMenuItem-ltr"]}</span>\n                </button>\n                <button class="b3-menu__item b3-menu__item--custom" id="tdirMenuItem-rtl">\n                    <svg class="b3-menu__icon " style=""><use xlink:href="#iconRtl"></use></svg>\n                    <span class="b3-menu__label">${a["tdirMenuItem-rtl"]}</span>\n                </button>                \n                <button class="b3-menu__separator"></button>\n                <button class="b3-menu__item" id="tdirMenuItem-clear">\n                    <svg class="b3-menu__icon " style=""><use xlink:href="#iconTrashcan"></use></svg>\n                    <span class="b3-menu__label">${a["afwdMenuItem-clear"]}\n                    </span>\n                </button>\n            </div>\n        </div>\n    `;d.innerHTML=m,o.insertBefore(d,null===(e=o.lastChild)||void 0===e?void 0:e.previousSibling)}))}(n);const s=yield(0,i.Mn)(t);let u=s["custom-afwd"],c=s["custom-tdir"];if(u||(u=""),c||(c=""),u=u.split(" "),u.length>0)if(e){if(u.forEach((n=>{const t=document.getElementById(`afwdMenuItem-${n}`);t&&(t.querySelector("input").checked=!0)})),u.includes("all")){const n=null==l?void 0:l.querySelectorAll("button[id^=afwdMenuItem]:not(#afwdMenuItem-all, #afwdMenuItem-clear)");null==n||n.forEach((n=>{n.classList.add("b3-menu__item--disabled"),n.querySelector("input").disabled=!0}))}}else{const n=document.getElementById(`afwdMenuItem-${u[0]}`);n&&n.classList.add("b3-menu__item--selected")}if(c.length&&e){const n=document.getElementById(`tdirMenuItem-${c}`);n&&n.classList.add("b3-menu__item--selected")}!function(n,t,e,o){const s=null==l?void 0:l.querySelectorAll("button[id^=afwdMenuItem]:not(#afwdMenuItem-clear)"),u=null==l?void 0:l.querySelectorAll("button[id^=tdirMenuItem]:not(#tdirMenuItem-clear)");let c=[];const r=[...s].filter((n=>"afwdMenuItem-all"!==n.id));n?(null==s||s.forEach((n=>{n.onclick=o=>{if(n.classList.contains("b3-menu__item--disabled"))return;const s=n.querySelector("input"),u=n.id.split("-")[1];let l=s.checked;o.target===s?l=!l:s.checked=!l,l?"all"===u?(r.forEach((n=>{n.classList.remove("b3-menu__item--disabled"),n.querySelector("input").disabled=!1})),e=c.length>0?c:[]):e=e.filter((n=>n!==u)):"all"===u?(e.includes("all")||(c=e),e=["all"],r.forEach((n=>{n.classList.add("b3-menu__item--disabled"),n.querySelector("input").disabled=!0}))):e.push(u),(0,i.Sn)(t,{"custom-afwd":e.join(" ")||""})}})),null==u||u.forEach(((n,e,s)=>{n.onclick=()=>{const u=n.id.split("-")[1];n.classList.contains("b3-menu__item--selected")?(n.classList.remove("b3-menu__item--selected"),o=[]):(o=[u],n.classList.add("b3-menu__item--selected"),s[1-e].classList.remove("b3-menu__item--selected")),(0,i.Sn)(t,{"custom-tdir":`${o.join("")}`})}}))):null==s||s.forEach(((n,o,s)=>{n.onclick=()=>{const u=n.id.split("-")[1];n.classList.contains("b3-menu__item--selected")?(e=[],n.classList.remove("b3-menu__item--selected")):(e=[u],n.classList.add("b3-menu__item--selected"),s[1-o].classList.remove("b3-menu__item--selected")),(0,i.Sn)(t,{"custom-afwd":(null==e?void 0:e.join(" "))||""})}}));const a=document.getElementById("afwdMenuItem-clear");if(!a)return;if(a.onclick=()=>{e=[],c=[],(0,i.Sn)(t,{"custom-afwd":""}),s.forEach((t=>{if(t.classList.remove("b3-menu__item--disabled"),t.classList.remove("b3-menu__item--selected"),n){const n=t.querySelector("input");n.disabled=!1,n.checked=!1}}))},!n)return;const d=document.getElementById("tdirMenuItem-clear");if(!d)return;d.onclick=()=>{o=[],(0,i.Sn)(t,{"custom-tdir":""}),u.forEach((n=>{n.classList.remove("b3-menu__item--selected")}))}}(e,t,u,c)}))}(b,v)}))},t.D=function(){null===u.Cn||void 0===u.Cn||u.Cn.forEach((n=>{(n.querySelector(".file-tree")?[]:n.querySelectorAll(".protyle-wysiwyg")).forEach((n=>{n.style.removeProperty("--protyle-spacing"),n.dataset.Pn=void 0}))}))};const i=e(613),s=e(629),u=e(937),c=e(553);t.dn=(0,s.yn)(d,200);const r=["NodeParagraph","NodeTable","NodeAttributeView","NodeSuperBlock","NodeVideo","NodeWidget","NodeIFrame"];let l,a=c.i18n;function d(){null===u.Cn||void 0===u.Cn||u.Cn.forEach((n=>{let t=n.querySelector(".file-tree")?[]:n.querySelectorAll(".protyle-wysiwyg");setTimeout((()=>{t.forEach((n=>{let t;t=n.style.paddingLeft,t!==n.dataset.Pn&&(n.style.setProperty("--protyle-spacing",t),n.dataset.Pn=t)}))}),300)}))}},21:n=>{n.exports=require("@electron/remote")},49:(n,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.h=t.L=void 0;const e=navigator.userAgent;let o=null,i=null,s=null,u=null,c=null,r=null,l=null,a=null,d=null,m=null,f=null,_=null,b=null,v=null,p=null,h=null,w=null,g=null;t.L={get An(){return null!=o?o:o=document.getElementById("layouts")},get j(){return null!=i?i:i=document.querySelector(".layout__center")},get toolbar(){return null!=s?s:s=document.getElementById("toolbar")},get In(){return null!=u?u:u=document.getElementById("dockLeft")},get $n(){return null!=c?c:c=document.getElementById("dockRight")},get On(){return null!=r?r:r=document.getElementById("dockBottom")},get status(){return null!=l?l:l=document.getElementById("status")},get jn(){return null!=a?a:a=document.querySelector(".layout__dockl")},get Ln(){return null!=d?d:d=document.querySelector(".layout__dockr")},get Bn(){return null!=m?m:m=document.querySelector(".layout__dockb")},get Tn(){return null!=f?f:f=document.getElementById("barSync")},get Rn(){return null!=_?_:_=document.getElementById("barForward")},get Nn(){return null!=b?b:b=document.getElementById("toolbarVIP")},get zn(){return null!=v?v:v=document.getElementById("drag")},get Fn(){return null!=p?p:p=document.getElementById("barPlugins")},get Dn(){return null!=h?h:h=document.getElementById("barSearch")},get Hn(){return null!=w?w:w=document.getElementById("barMode")},get Vn(){return null!=g?g:g=document.getElementById("barMore")}},t.h={En:navigator.platform.indexOf("Mac")>-1,Jn:navigator.platform.indexOf("Linux")>-1,Un:/Android/.test(e),p:!!document.getElementById("sidebar"),Wn:!e.startsWith("SiYuan")||e.indexOf("iPad")>-1||/Android/.test(e)&&!/(?:Mobile)/.test(e),Kn:document.body.classList.contains("body--window"),Z:(/iOS/i.test(e)||/iPad/i.test(e))&&/AppleWebKit/i.test(e)&&e.startsWith("SiYuan/"),lang:window.siyuan.config.lang,nn:CSS.supports("color","oklch(from red calc(l * 0.5) 0 h)"),Yn:window.siyuan.config.readonly,qn:window.siyuan.config.appearance.mode>0?"dark":"light",Gn:/^((?!chrome|android).)*safari/i.test(e)}},54:(n,t)=>{function e(){document.querySelectorAll(".asri-selected-block").forEach((n=>n.classList.remove("asri-selected-block")))}Object.defineProperty(t,"__esModule",{value:!0}),t.en=function(n){const t=new Promise((n=>{const t=()=>{document.removeEventListener("mouseup",t,!0),n()};document.addEventListener("mouseup",t,!0)})),o=new Promise((n=>{setTimeout(n,300)})),i=new Promise((n=>{const t=()=>{document.removeEventListener("keyup",t,!0),n()};document.addEventListener("keyup",t,!0)}));Promise.race([t,i,o]).then((()=>{const n=window.getSelection(),t=n&&n.rangeCount>0?n.getRangeAt(0):null;if(!t)return;const o=t.commonAncestorContainer.parentElement,i=o?o.closest("[data-node-id]"):null;if(!i)return;const s=i.getAttribute("data-type");e(),s&&!["NodeAttributeView","NodeCodeBlock","NodeList","NodeHTMLBlock"].includes(s)&&i.classList.add("asri-selected-block")}))},t.J=e},130:(n,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.u=function(){i.h.En&&(i.h.Wn||s(16),i.h.Kn&&s(14))},t.q=function(){i.h.En&&(i.h.Wn||s(8),i.h.Kn&&s(8,13))};const o=e(571),i=e(49);function s(n,t=n){o.remote&&o.remote.getCurrentWindow().setWindowButtonPosition({x:n,y:t})}},261:(n,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.o=function(){i.forEach((({Qn:n,className:t})=>{n&&document.body.classList.add(t)}))},t.K=function(){i.forEach((({className:n})=>{document.body.classList.remove(n)}))};const o=e(49),i=[{Qn:o.h.En,className:"body-asri--mac"},{Qn:o.h.Jn,className:"body-asri--linux"},{Qn:o.h.p,className:"body-asri--mobile"},{Qn:o.h.Wn,className:"body-asri--browser"},{Qn:o.h.Un,className:"body-asri--android"},{Qn:o.h.Z,className:"body-asri--iosApp"},{Qn:o.h.Yn,className:"body-asri--readOnly"},{Qn:o.h.Gn,className:"body-asri--safari"}]},288:function(n,t){var e=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function u(n){try{r(o.next(n))}catch(n){s(n)}}function c(n){try{r(o.throw(n))}catch(n){s(n)}}function r(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(u,c)}r((o=o.apply(n,t||[])).next())}))};function o(){return e(this,arguments,void 0,(function*(n=600,t,o=0){if(document.startViewTransition)if(o>0){const i=n=>new Promise((t=>setTimeout(t,n)));document.startViewTransition((()=>e(this,void 0,void 0,(function*(){yield Promise.race([i(o)]),t&&t()})))).ready.then((()=>{document.documentElement.animate({opacity:[0,1]},{duration:n})}))}else{const e=document.startViewTransition(t),o=document.createElement("style");o.textContent=`\n            ::view-transition-old(root),\n            ::view-transition-new(root) {\n                animation-duration: ${n}ms;\n            }\n        `,document.head.appendChild(o),yield e.finished,o.remove()}else t&&t()}))}Object.defineProperty(t,"__esModule",{value:!0}),t.I=void 0,t.pn=function(n){return e(this,void 0,void 0,(function*(){if("mouseup"!==n.type)return;n.target.closest('[data-name="barmode"] .b3-menu__item:not([id])')&&o()}))},t._n=o,t.I=window.matchMedia("(prefers-color-scheme: dark)")},376:function(n,t,e){var o=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function u(n){try{r(o.next(n))}catch(n){s(n)}}function c(n){try{r(o.throw(n))}catch(n){s(n)}}function r(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(u,c)}r((o=o.apply(n,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.M=w,t.xn=function(){return o(this,void 0,void 0,(function*(){s.h.En&&((0,u.isFullScreen)()?(document.body.classList.add("body-asri--fullscreen"),b-=h?0:88,h=!0):(document.body.classList.remove("body-asri--fullscreen"),null==r||r.style.setProperty("width","0px"),b=yield w("initials","L"),null==r||r.style.removeProperty("width"),h=!1))}))},t.rn=function(){return o(this,arguments,void 0,(function*(n=0,t=!1,e=!1){if(s.h.Kn||s.h.p)return{Xn:!1,Zn:0};let u=s.L.j||(yield(0,i.B)(".layout__center"));return new Promise((i=>o(this,void 0,void 0,(function*(){var o,c,l,a,d,g;t&&(v+=n),b&&v||(yield w("initials")),m=u.getBoundingClientRect(),_=s.L.Tn.getBoundingClientRect(),f=s.L.Rn.getBoundingClientRect();let y=m.left,x=m.right,k=s.L.Dn.getBoundingClientRect().left;t||(y>b+8?(null==p||p.style.setProperty("--topbar-left-spacing","0"),s.h.En&&h||(yield w("initials","L")),null==r||r.classList.remove("asri-expanded")):s.h.En&&!s.h.Wn?(p.style.setProperty("--topbar-left-spacing",y-_.right+4+"px"),null==r||r.classList.add("asri-expanded")):(p.style.setProperty("--topbar-left-spacing",y-f.right+4+"px"),null==r||r.classList.add("asri-expanded")),x<v-8&&!e?(p.style.setProperty("--topbar-right-spacing","0"),yield w("initials","R"),null===(o=s.L.$n)||void 0===o||o.style.removeProperty("--avoid-topbar"),null===(c=s.L.Ln)||void 0===c||c.style.removeProperty("--avoid-topbar")):s.h.En||s.h.Wn?(p.style.setProperty("--topbar-right-spacing",window.innerWidth-x+1+"px"),null===(l=s.L.$n)||void 0===l||l.style.setProperty("--avoid-topbar","4px"),null===(a=s.L.Ln)||void 0===a||a.style.setProperty("--avoid-topbar","4px")):(p.style.setProperty("--topbar-right-spacing",k-x+6+"px"),null===(d=s.L.$n)||void 0===d||d.style.setProperty("--avoid-topbar","calc(var(--toolbar-height) - 6px)"),null===(g=s.L.Ln)||void 0===g||g.style.setProperty("--avoid-topbar","calc(var(--toolbar-height) - 6px)"))),i({Xn:!0,Zn:x})}))))}))},t.an=function(){return o(this,arguments,void 0,(function*({Xn:n,Zn:t}={Xn:!1,Zn:0}){var e,r;n&&(a=null===(e=s.L.toolbar)||void 0===e?void 0:e.getBoundingClientRect(),yield w("rect"),m=null===(r=s.L.j)||void 0===r?void 0:r.getBoundingClientRect(),(c||(c=document.getElementById("AsriPluginsIconsDivider")))&&(t<v-8?(c.style.setProperty("--container-bg","var(--b3-border-color-trans))"),c.style.left=t+"px",c.style.right="0",c.style.removeProperty("height"),c.style.removeProperty("top"),c.style.removeProperty("width")):(c.style.setProperty("--container-bg","var(--b3-border-color-trans)"),c.style.left=d.right-10+"px",c.style.width="2px",c.style.height="21px",c.style.top="13.5px")),null===u.Cn||void 0===u.Cn||u.Cn.forEach((n=>o(this,void 0,void 0,(function*(){let t,e=n.querySelector('.fn__flex-column[data-type="wnd"] > .fn__flex:first-child');if(e.classList.contains("fn__none")&&(e=yield(0,i.B)('.fn__flex-column[data-type="wnd"] > .fn__flex:first-child:not(.fn__none)',n,3)),t=null==e?void 0:e.getBoundingClientRect(),!t)return;let o=t.left<d.left?d.left-t.left-4:0,u=t.right>d.right?t.right-d.right+8:0;(0,i.nt)(e,s.L.zn)||(0,i.nt)(e,s.L.toolbar)?(e.style.paddingLeft=o+"px",e.style.paddingRight=u+"px",t.right-u-240<d.left&&t.left<d.left||t.left+o+240>d.right&&t.right>d.right?(e.style.paddingTop="42px",e.style.paddingLeft="0",e.style.paddingRight="0"):e.style.removeProperty("padding-top")):(e.style.removeProperty("padding-left"),e.style.removeProperty("padding-right"),e.style.removeProperty("padding-top"))})))))}))},t.R=function(){return o(this,void 0,void 0,(function*(){var n,t;yield(0,u.k)(),function(){c&&c.remove();r&&(r.remove(),r=void 0);l&&(l.remove(),l=void 0)}(),null===u.Cn||void 0===u.Cn||u.Cn.forEach((n=>{let t=n.firstElementChild;t.style.removeProperty("padding-top"),t.style.removeProperty("padding-left"),t.style.removeProperty("padding-right")})),s.L.j.dataset.fn=void 0,document.body.dataset.fn=void 0,null===(n=s.L.$n)||void 0===n||n.style.removeProperty("--avoid-topbar"),null===(t=s.L.Ln)||void 0===t||t.style.removeProperty("--avoid-topbar")}))},t.S=function(){if(s.h.p)return;c=g("AsriPluginsIconsDivider",void 0,s.L.zn),r=s.h.En&&!s.h.Wn?g("AsriTopbarLeftSpacing",void 0,s.L.Tn):g("AsriTopbarLeftSpacing",void 0,s.L.Rn),l=s.h.En||s.h.Wn?g("AsriTopbarRightSpacing"):g("AsriTopbarRightSpacing",s.L.Dn);const n=document.createElementNS("http://www.w3.org/2000/svg","svg");null==l||l.appendChild(n.cloneNode(!0)),null==c||c.appendChild(n.cloneNode(!0)),null==r||r.appendChild(n.cloneNode(!0))},t.gn=function(){return o(this,void 0,void 0,(function*(){r&&l&&(r.style.setProperty("width","0px"),l.style.setProperty("width","0px"),yield w("initials"),r.style.removeProperty("width"),l.style.removeProperty("width"))}))};const i=e(629),s=e(49),u=e(937);let c,r,l,a,d,m,f,_,b,v,p=s.L.toolbar,h=!1;function w(){return o(this,arguments,void 0,(function*(n="rect",...t){const e=s.L.zn||(yield(0,i.B)("#drag"));return!e||s.h.Kn?-1:new Promise((o=>{"initials"===n?(t.length&&!t.includes("L")||(b=e.getBoundingClientRect().left,o(b)),t.length&&!t.includes("R")||(v=e.getBoundingClientRect().right,o(v))):(d=e.getBoundingClientRect(),o(d))}))}))}function g(n,t=void 0,e=void 0){if(document.getElementById(n))return;if(!s.L.toolbar)return;let o=document.createElement("div");return o.id=n,t?s.L.toolbar.insertBefore(o,t):e?s.L.toolbar.insertBefore(o,e.nextSibling):s.L.toolbar.appendChild(o),o}},414:function(n,t,e){var o=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function u(n){try{r(o.next(n))}catch(n){s(n)}}function c(n){try{r(o.throw(n))}catch(n){s(n)}}function r(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(u,c)}r((o=o.apply(n,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.mn=void 0,t.tt=c,t.l=function(){const n=(0,i.et)()?0:32;document.body.style.setProperty("--status-height",`${n}px`)},t.W=function(){document.body.style.removeProperty("--status-height"),setTimeout((()=>{var n,t,e;null===(n=s.L.status)||void 0===n||n.style.removeProperty("max-width"),null===(t=s.L.status)||void 0===t||t.style.removeProperty("--asri-status-transform-x"),null===(e=s.L.status)||void 0===e||e.style.removeProperty("--asri-status-transform-y")}),200)},t.P=function(){var n,t;if(!(0,i.et)()){const e=null===(n=s.L.An)||void 0===n?void 0:n.querySelectorAll(".layout__center .layout-tab-container"),o=s.L.status;null==e||e.forEach((n=>{let t=n.querySelector(".file-tree");t&&!t.classList.contains("fn__none")&&(0,u.nt)(n,o)?n.style.paddingBottom="35px":n.style.removeProperty("padding-bottom")}));const i=document.getElementById("searchList"),c=document.getElementById("searchPreview");(i||c)&&((0,u.nt)(i,o)?i.style.paddingBottom="35px":i.style.removeProperty("padding-bottom"),(0,u.nt)(c,o)?c.style.paddingBottom="35px":c.style.removeProperty("padding-bottom"));const r=document.getElementById("viewerContainer");r&&((0,u.nt)(r,o)?r.style.paddingBottom="35px":r.style.removeProperty("padding-bottom")),null===(t=s.L.An)||void 0===t||t.querySelectorAll(".card__main").forEach((n=>{n&&((0,u.nt)(n,o)?n.style.paddingBottom="35px":n.style.removeProperty("padding-bottom"))}))}},t.U=function(){var n,t;null===(n=s.L.An)||void 0===n||n.querySelectorAll(".layout__center .layout-tab-container").forEach((n=>{n.style.removeProperty("padding-bottom")})),null===(t=s.L.An)||void 0===t||t.querySelectorAll(".card__main").forEach((n=>{n.style.removeProperty("padding-bottom")}));const e=document.getElementById("searchList"),o=document.getElementById("searchPreview"),i=document.getElementById("viewerContainer");for(const n of[e,o,i])n&&n.style.removeProperty("padding-bottom")};const i=e(937),s=e(49),u=e(629);function c(){return o(this,void 0,void 0,(function*(){var n,t,e;if(!s.h.p&&!s.h.Kn)if(s.L.status||(yield(0,u.B)("#status")),yield(0,i.ot)())null===(n=s.L.status)||void 0===n||n.style.removeProperty("max-width"),null===(t=s.L.status)||void 0===t||t.style.removeProperty("--asri-status-transform-x"),null===(e=s.L.status)||void 0===e||e.style.removeProperty("--asri-status-transform-y");else{function o(n,t){s.L.status.style.setProperty("--asri-status-transform-x",`${n}px`),s.L.status.style.setProperty("--asri-status-transform-y",`${t}px`)}let c=(s.L.An||(yield(0,u.B)("#layouts"))).querySelector(".layout__center");if(c&&s.L.Ln&&!s.L.status.classList.contains(".fn__none")){let r=s.L.Ln.clientWidth,l=c.clientWidth,a=0;s.L.Bn||(yield(0,u.B)(".layout__dockb")),a=s.L.Bn&&!s.L.Bn.classList.contains(".fn__none")&&(0,i.it)("B")?-1*s.L.Bn.clientHeight:0,s.L.status.style.maxWidth=l-12+"px";let d=(0,i.st)("R"),m=!(0,i.it)("R")&&(0,i.ut)("R");d&&m?o(0,a):!d&&m?o(-40,a):d||m?d&&!m&&o(-1*r,a):o(-1*(r+40),a)}}}))}t.mn=(0,u.yn)(c)},553:function(n,t,e){var o=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function u(n){try{r(o.next(n))}catch(n){s(n)}}function c(n){try{r(o.throw(n))}catch(n){s(n)}}function r(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(u,c)}r((o=o.apply(n,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.$=t.O=t.followSysAccentColor=t.i18n=void 0,t.m=function(){return o(this,void 0,void 0,(function*(){d=r.h.qn,function(){return o(this,void 0,void 0,(function*(){yield(0,i.getFile)("/data/snippets/Asri.config.json").then((n=>n&&200===n.status?n.json():null)).then((n=>{var e,o,i;if(!n)return void(t.followSysAccentColor=a[d].followSysAccentColor);for(let t in a)t in n||(n[t]=a[t]);const s=["light","dark"];for(const t of s)a[t].followSysAccentColor=!!n[t].followSysAccentColor,a[t].chroma=null!==(e=n[t].chroma)&&void 0!==e?e:"1",a[t].userCustomColor=null!==(o=n[t].userCustomColor)&&void 0!==o?o:"#3478f6",a[t].presetPalette=null!==(i=n[t].presetPalette)&&void 0!==i?i:"";a.features=n.features,t.followSysAccentColor=!!n[d].followSysAccentColor}))}))}().then((()=>{if(r.h.nn){if(r.h.Wn||r.h.p||r.h.Jn?(document.documentElement.style.setProperty("--asri-user-custom-accent",a[d].userCustomColor),T(a[d].userCustomColor)):t.followSysAccentColor?document.documentElement.style.removeProperty("--asri-user-custom-accent"):(document.documentElement.style.setProperty("--asri-user-custom-accent",a[d].userCustomColor),T(a[d].userCustomColor)),a[d].presetPalette){const n=a[d].presetPalette,e=S[n][d];document.documentElement.setAttribute("data-asri-palette",n.split("-")[2]),t.followSysAccentColor=!1,document.documentElement.style.setProperty("--asri-user-custom-accent",e.primary),document.documentElement.style.setProperty("--asri-c-factor",e.chroma),x="0"===e.chroma,L(e.chroma),T(e.primary)}else document.documentElement.style.setProperty("--asri-c-factor",a[d].chroma),document.documentElement.removeAttribute("data-asri-palette"),x="0"===a[d].chroma,L(a[d].chroma);j(),a.features.tfp&&document.body.classList.add("asri-tfp","asri-tfp-"+a.features.tfp)}}))}))},t.G=function(){document.documentElement.style.removeProperty("--asri-user-custom-accent"),document.documentElement.style.removeProperty("--asri-sys-accent-grayscale"),document.documentElement.style.removeProperty("--asri-c-factor"),document.documentElement.style.removeProperty("--asri-sys-accent"),document.documentElement.style.removeProperty("--asri-sys-accent-accessible"),document.documentElement.style.removeProperty("--asri-c-0"),document.documentElement.style.removeProperty("--asri-on-primary-reverse"),document.querySelectorAll(".asri-config").forEach((n=>n.remove()))},t.v=k,t.bn=function(n){return o(this,void 0,void 0,(function*(){var e,o;if("mouseup"!==n.type)return;Object.keys(t.i18n).length||(t.i18n=yield k());if(!n.target.closest(".toolbar__item"))return;if(document.querySelector(".asri-config"))return;let i=yield(0,c.B)('#commonMenu[data-name="barmode"] .b3-menu__items',document,2,0);if(!i)return;const s=`\n        <button class="b3-menu__separator asri-config"></button>\n        <div class="menu-item__subtitle" style="user-select: none;">${t.i18n["palette-presets"]}</div>\n        ${Object.keys(S).map((n=>C(n))).join("")}\n        <button class="b3-menu__separator asri-config"></button>\n        <button class="b3-menu__item asri-config" id="pickColor">\n            <svg class="b3-menu__icon"></svg>\n            <input id="asriColorPicker" type="color" value="${a[d].userCustomColor}">\n            <label for="asriColorPicker" class="be-menu__label">${t.i18n.pickColor}</label>\n        </button>\n        <button class="b3-menu__item asri-config" id="followSysAccent">\n            <svg class="b3-menu__icon"></svg>\n            <label for="" class="be-menu__label">${t.i18n.followSysAccent}</label>\n        </button>\n        <button class="b3-menu__item asri-config" data-type="nobg" id="asriChroma">\n            <svg class="b3-menu__icon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">\n                <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m19 11l-8-8l-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0zM5 2l5 5m-8 6h15m5 7a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4c.3 1.6 2 2.4 2 4" />\n            </svg>\n            <div aria-label="${t.i18n.asriChroma+(null!==(o=null!==(e=null==v?void 0:v.value)&&void 0!==e?e:a[d].chroma)&&void 0!==o?o:"1")}" class="b3-tooltips b3-tooltips__n">\n                <input style="box-sizing: border-box" type="range" id="asriChromaSlider" class="b3-slider fn__block" min="0" max="5" step="0.1" value="1">\n            </div>\n        </button>\n        <button class="b3-menu__separator asri-config"></button>\n        <button class="b3-menu__item asri-config" id="topbarFusionPlus"></button>\n`,u=document.createRange().createContextualFragment(s);i.appendChild(u),_=document.getElementById("followSysAccent"),b=document.getElementById("pickColor"),v=document.getElementById("asriChromaSlider"),p=b.querySelector("input"),h=document.getElementById("topbarFusionPlus"),h.innerHTML=`\n        <svg class="b3-menu__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="m8 10.5l6.492-6.492M13.496 16L20 9.496zm-4.91-.586L19.413 4.587M8 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2z"/><path d="M16 16v2a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2"/></g></svg>\n        <span class="b3-menu__label" style="display: flex">${t.i18n.topbarFusionPlus}<svg data-position="north" class="b3-menu__icon ariaLabel asri-experimental" aria-label=${'"'+t.i18n["tfp-experimental"]+'"'} style="vertical-align: -.1em; height: .8em; width: .8em; opacity: .5; padding-inline-start: .1em; margin-right: unset;margin-inline-start: auto; margin-inline-end: 0;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 23 23"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2M6.453 15h11.094M8.5 2h7"/></svg></span>\n        <svg class="b3-menu__icon b3-menu__icon--small">\n            <use xlink:href="#iconRight"></use>\n        </svg>\n        <div class="b3-menu__submenu">\n            <div class="b3-menu__items">\n                <button class="b3-menu__item" id="tfp-progressive">\n                    <svg class="b3-menu__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="m8 10.5l6.492-6.492M13.496 16L20 9.496zm-4.91-.586L19.413 4.587M8 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2z"/><path d="M16 16v2a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2"/></g></svg>\n                    <span class="b3-menu__label">${t.i18n["tfp-progressive"]}</span>\n                </button>\n                <button class="b3-menu__item" id="tfp-acrylic">\n                    <svg class="b3-menu__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="m8 10.5l6.492-6.492M13.496 16L20 9.496zm-4.91-.586L19.413 4.587M8 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2z"/><path d="M16 16v2a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2"/></g></svg>\n                    <span class="b3-menu__label">${t.i18n["tfp-acrylic"]}</span>\n                </button>                \n                <button class="b3-menu__separator"></button>\n                <button class="b3-menu__item" id="tfp-disable">\n                    <svg class="b3-menu__icon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">\n                        <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m15 9l-6 6m0-6l6 6"/></g>\n                    </svg>\n                    <span class="b3-menu__label">${t.i18n["tfp-disable"]}</span>\n                </button>\n            </div>\n        </div>\n    `,_&&b&&v&&p&&(function(){const n=document.getElementById("asriChroma");w=document.getElementById("tfp-progressive"),g=document.getElementById("tfp-acrylic"),a[d].presetPalette&&(null==b||b.classList.add("b3-menu__item--disabled"),null==_||_.classList.add("b3-menu__item--disabled"),null==n||n.classList.add("b3-menu__item--disabled"));if(_.classList.toggle("b3-menu__item--selected",!a[d].presetPalette&&t.followSysAccentColor),b.classList.toggle("b3-menu__item--selected",!a[d].presetPalette&&!t.followSysAccentColor),v.value=a[d].chroma||"1",v.parentElement.ariaLabel=t.i18n.asriChroma+a[d].chroma,a[d].presetPalette){const n=document.getElementById(`${a[d].presetPalette}`);null==n||n.classList.add("b3-menu__item--selected")}w&&g&&(w.classList.toggle("b3-menu__item--selected","progressive"===a.features.tfp),g.classList.toggle("b3-menu__item--selected","acrylic"===a.features.tfp))}(),function(){if(!(_&&b&&v&&p))return;r.h.Wn||r.h.p||r.h.Jn?_.classList.add("fn__none"):_.addEventListener("mouseup",P);b.addEventListener("click",A),p.addEventListener("input",I),p.addEventListener("change",$),v.addEventListener("input",O)}())}))},t.tn=j;const i=e(613),s=e(571),u=e(796),c=e(629),r=e(49),l=e(288),a={light:{followSysAccentColor:!1,chroma:"1",userCustomColor:"#3478f6",presetPalette:""},dark:{followSysAccentColor:!1,chroma:"1",userCustomColor:"#3478f6",presetPalette:""},features:{tfp:""}};let d;const m=(0,c.yn)(M,200);let f,_,b,v,p,h,w,g,y=!1,x=!1;function k(){return o(this,void 0,void 0,(function*(){let n;try{return n=["zh_CN","zh_CHT","en_US","ar_SA"].includes(r.h.lang)?yield fetch(`/appearance/themes/Asri/i18n/${r.h.lang}.json`):yield fetch("/appearance/themes/Asri/i18n/en_US.json"),t.i18n=yield n.json(),t.i18n}catch(n){throw n}}))}function M(){return o(this,void 0,void 0,(function*(){yield(0,i.ct)("/data/snippets/Asri.config.json",JSON.stringify(a,void 0,4))}))}t.followSysAccentColor=!1;const S={"prst-palette-auriflow":{dark:{primary:"#D2B983",chroma:"0.3",followSysAccentColor:!1},light:{primary:"#F4D18B",chroma:"0",followSysAccentColor:!1}},"prst-palette-everbliss":{dark:{primary:"#13012a",chroma:"1.5",followSysAccentColor:!1},light:{primary:"#F4CA57",chroma:"2.8",followSysAccentColor:!1}},"prst-palette-aerisland":{dark:{primary:"#111a3f",chroma:"2",followSysAccentColor:!1},light:{primary:"#e6f9db",chroma:"2",followSysAccentColor:!1}},"prst-palette-zerith":{dark:{primary:"#ABC3D9",chroma:"2.4",followSysAccentColor:!1},light:{primary:"#C2E2DF",chroma:"0.7",followSysAccentColor:!1}}},C=n=>`<button class="b3-menu__item asri-config" id="${n}"><svg class="b3-menu__icon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M19 3h-4a2 2 0 0 0-2 2v12a4 4 0 0 0 8 0V5a2 2 0 0 0-2-2"/><path d="m13 7.35l-2-2a2 2 0 0 0-2.828 0L5.344 8.178a2 2 0 0 0 0 2.828l9 9"/><path d="M7.3 13H5a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h12m0-4v.01"/></g></svg><span class="b3-menu__label">${t.i18n[n]||n}</span></button>`;function P(){(0,l._n)(600,(()=>{document.querySelectorAll(".asri-config.b3-menu__item--selected").forEach((n=>n.classList.remove("b3-menu__item--selected"))),a[d].followSysAccentColor?(t.followSysAccentColor=!1,b.classList.add("b3-menu__item--selected"),document.documentElement.style.setProperty("--asri-user-custom-accent",a[d].userCustomColor||f||"#3478f6"),L(a[d].chroma),T(a[d].userCustomColor||f||"#3478f6"),a[d].followSysAccentColor=!1):(t.followSysAccentColor=!0,_.classList.add("b3-menu__item--selected"),document.documentElement.style.removeProperty("--asri-user-custom-accent"),a[d].followSysAccentColor=!0,j()),M()}))}function A(n){(0,l._n)(600,(()=>{t.followSysAccentColor&&(t.followSysAccentColor=!1,_.classList.remove("b3-menu__item--selected"),b.classList.add("b3-menu__item--selected"),document.documentElement.style.setProperty("--asri-user-custom-accent",a[d].userCustomColor),L(a[d].chroma),T(a[d].userCustomColor),a[d].userCustomColor=a[d].userCustomColor,a[d].followSysAccentColor=!1,M())}))}function I(){const n=p.value;document.documentElement.style.setProperty("--asri-user-custom-accent",n),T(n)}function $(){_.classList.remove("b3-menu__item--selected"),b.classList.add("b3-menu__item--selected"),T(p.value),a[d].userCustomColor=p.value,t.followSysAccentColor=!1,a[d].followSysAccentColor=!1,M()}function O(){const n=this.value;document.documentElement.style.setProperty("--asri-c-factor",n),this.parentElement.ariaLabel=t.i18n.asriChroma+n,a[d].chroma=n,x="0"===n,L(n),m()}function j(){if(!(r.h.Wn||r.h.p||r.h.Jn)){const n="#"+s.remote.systemPreferences.getAccentColor().slice(0,6),e=(0,c.rt)(n);if(!e)return;f!==n&&(document.documentElement.style.setProperty("--asri-sys-accent",n),e.s>.28?document.documentElement.style.setProperty("--asri-sys-accent-accessible",n):document.documentElement.style.removeProperty("--asri-sys-accent-accessible"),y=0===e.s,f=n),t.followSysAccentColor&&(L(e.s),T(n))}}function L(n){return"0"===String(n)||t.followSysAccentColor&&y||x?(document.documentElement.style.setProperty("--asri-c-0","0"),!0):(document.documentElement.style.removeProperty("--asri-c-0"),!1)}t.O=new u.X((function(n){const t=n.target.closest('[id^="tfp-"]');if(!t)return;const e=document.querySelectorAll('[id^="tfp-"]');"tfp-disable"===t.id?(document.body.classList.remove("asri-tfp-acrylic","asri-tfp-progressive","asri-tfp"),e.forEach((n=>{n.classList.remove("b3-menu__item--selected")})),a.features.tfp=""):(t.classList.contains("b3-menu__item--selected")?(document.body.classList.remove("asri-tfp",t.id.replace("tfp-","asri-tfp-")),a.features.tfp=""):(e.forEach((n=>{n.classList.remove("b3-menu__item--selected")})),document.body.classList.remove("asri-tfp-acrylic","asri-tfp-progressive"),document.body.classList.add("asri-tfp",t.id.replace("tfp-","asri-tfp-")),a.features.tfp=t.id.replace("tfp-","")),t.classList.toggle("b3-menu__item--selected"));M()}));const B="light"===r.h.qn?.81:.79;function T(n){const t=(0,c.lt)(n);t&&(t>B?document.documentElement.style.setProperty("--asri-on-primary-reverse","light"===r.h.qn?".4":".3"):document.documentElement.style.removeProperty("--asri-on-primary-reverse"))}t.$=new u.X((function(n){return o(this,void 0,void 0,(function*(){const e=n.target.closest('[id^="prst-palette-"]');if(!e)return;const o=document.getElementById("asriChroma"),i=e.id,s=S[i][d];document.querySelectorAll('[id^="prst-palette-"]').forEach((n=>n.classList.remove("b3-menu__item--selected"))),(0,l._n)(600,(()=>{a[d].presetPalette===i?(e.classList.remove("b3-menu__item--selected"),document.documentElement.removeAttribute("data-asri-palette"),null==b||b.classList.remove("b3-menu__item--disabled"),null==_||_.classList.remove("b3-menu__item--disabled"),null==o||o.classList.remove("b3-menu__item--disabled"),a[d].presetPalette="",t.followSysAccentColor=a[d].followSysAccentColor,t.followSysAccentColor?(_.classList.add("b3-menu__item--selected"),document.documentElement.style.removeProperty("--asri-user-custom-accent"),a[d].followSysAccentColor=!0,j()):(b.classList.add("b3-menu__item--selected"),document.documentElement.style.setProperty("--asri-user-custom-accent",a[d].userCustomColor||f||"#3478f6"),a[d].followSysAccentColor=!1),document.documentElement.style.setProperty("--asri-c-factor",a[d].chroma),x="0"===a[d].chroma,L(a[d].chroma),T(t.followSysAccentColor?f:a[d].userCustomColor),M()):(e.classList.add("b3-menu__item--selected"),document.documentElement.setAttribute("data-asri-palette",i.split("-")[2]),null==b||b.classList.add("b3-menu__item--disabled"),null==_||_.classList.add("b3-menu__item--disabled"),null==o||o.classList.add("b3-menu__item--disabled"),t.followSysAccentColor=!1,_.classList.remove("b3-menu__item--selected"),b.classList.remove("b3-menu__item--selected"),document.documentElement.style.setProperty("--asri-user-custom-accent",s.primary),document.documentElement.style.setProperty("--asri-c-factor",s.chroma),x="0"===s.chroma,L(s.chroma),T(s.primary),a[d].presetPalette=i,M())}))}))}))},571:(n,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.remote=void 0;const o=e(49);t.remote=o.h.Wn||o.h.p?null:e(21)},613:function(n,t){var e=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function u(n){try{r(o.next(n))}catch(n){s(n)}}function c(n){try{r(o.throw(n))}catch(n){s(n)}}function r(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(u,c)}r((o=o.apply(n,t||[])).next())}))};function o(n){return e(this,void 0,void 0,(function*(){let t=yield n;return 0===t.code?t.data:null}))}function i(n,t){return e(this,void 0,void 0,(function*(){let e=null;return yield fetch(n,{body:JSON.stringify(t),method:"POST",headers:{Authorization:"Token "}}).then((function(n){e=n.json()})),e}))}Object.defineProperty(t,"__esModule",{value:!0}),t.getFile=function(n){return e(this,void 0,void 0,(function*(){const t=yield fetch("/api/file/getFile",{method:"POST",body:JSON.stringify({path:n})});return t.ok?t:null}))},t.ct=function(n,t){return e(this,arguments,void 0,(function*(n,t,e=!1,o=Date.now()){let i=new Blob([t]),s=n.split("/").pop(),u=new File([i],s),c=new FormData;c.append("path",n),c.append("file",u),c.append("isDir",String(e)),c.append("modTime",String(o));const r=yield fetch("/api/file/putFile",{body:c,method:"POST"});return r.ok?yield r.json():null}))},t.Sn=function(n,t){return e(this,void 0,void 0,(function*(){return o(i("/api/attr/setBlockAttrs",{id:n,attrs:t}))}))},t.Mn=function(n){return e(this,void 0,void 0,(function*(){return o(i("/api/attr/getBlockAttrs",{id:n}))}))}},629:function(n,t){var e=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function u(n){try{r(o.next(n))}catch(n){s(n)}}function c(n){try{r(o.throw(n))}catch(n){s(n)}}function r(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(u,c)}r((o=o.apply(n,t||[])).next())}))};function o(n,t){let e=!1;return n&&t&&(e=n.right>t.left&&n.bottom>t.top&&n.left<t.left+t.width&&n.top<t.top+t.height),e}function i(n){return e(this,arguments,void 0,(function*(n,t=document,e=10,o=200){let i=0;for(;i<e;){const e=t.querySelector(n);if(e)return e;yield new Promise((n=>setTimeout(n,o))),i++}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.dt=function(n,t){n.includes(t)||n.push(t)},t.yn=function(n,t=200){let e=null;return(...o)=>{e&&clearTimeout(e),e=setTimeout((()=>{n(...o),e=null}),t)}},t.rt=function(n){if(!n)return;const t=parseInt(n.substring(1,3),16)/255,e=parseInt(n.substring(3,5),16)/255,o=parseInt(n.substring(5,7),16)/255,i=Math.max(t,e,o),s=Math.min(t,e,o),u=(i+s)/2;if(i===s)return{ft:0,s:0,_t:u};let c=0;const r=i-s,l=u>.5?r/(2-i-s):r/(i+s);switch(i){case t:c=(e-o)/r+(e<o?6:0);break;case e:c=(o-t)/r+2;break;case o:c=(t-e)/r+4}return c/=6,{ft:c,s:l,_t:u}},t.lt=function(n){if(!n)return;4===(n=n.replace(/^#/,"")).length?n.substring(0,3):8===n.length&&n.substring(0,6);3===n.length&&(n=n.split("").map((function(n){return n+n})).join(""));let t=parseInt(n.slice(0,2),16)/255,e=parseInt(n.slice(2,4),16)/255,o=parseInt(n.slice(4,6),16)/255;t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,o=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92;let i=.4124564*t+.3575761*e+.1804375*o,s=.2126729*t+.7151522*e+.072175*o,u=.0193339*t+.119192*e+.9503041*o,c=.8189330101*i+.3618667424*s-.1288597137*u,r=.0329845436*i+.9293118715*s+.0361456387*u,l=.0482003018*i+.2643662691*s+.633851707*u;return c=Math.cbrt(c),r=Math.cbrt(r),l=Math.cbrt(l),.2104542553*c+.793617785*r-.0040720468*l},t.nt=function(n,t){if(!n||!t)return!1;let e,i;e=n.getBoundingClientRect(),i=t.getBoundingClientRect();return o(e,i)},t.bt=function(n,t){return e(this,void 0,void 0,(function*(){return!(!n||!t)&&new Promise((e=>{let i,s;i=n.getBoundingClientRect(),s=t.getBoundingClientRect();e(o(i,s))}))}))},t.vt=function(n,t){if(!n.length||!t.length)return!1;const e=new Set(n),o=new Set(t);if(e.size!==o.size)return!1;for(const n of e)if(!o.has(n))return!1;return!0},t.B=i,t.ht=function(n){return e(this,arguments,void 0,(function*(n,t=document,e=10,o=200){let i=0;for(;i<e;){const e=t.querySelectorAll(n);if(e.length>0)return e;yield new Promise((n=>setTimeout(n,o))),i++}}))},t.wt=function(n){return e(this,void 0,void 0,(function*(){var t;if(!n){const e=yield i(".layout__center .layout-tab-bar .item--focus");n=null!==(t=null==e?void 0:e.getAttribute("data-id"))&&void 0!==t?t:void 0}const e=document.querySelector(`.layout__center .layout-tab-container>[data-id="${n}"]:not(.fn__none)`);return!e||e.classList.contains("protyle")}))}},766:(n,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.A=t.sn=t.cn=void 0;t.cn=class{constructor(n){this.gt=(t,e)=>n(t,e),this.yt=new ResizeObserver(this.gt)}observe(n,t){this.yt.observe(n,t)}disconnect(n){this.yt.disconnect(),n&&n()}unobserve(n){this.yt.unobserve(n)}};t.sn=class{constructor(n){this.gt=(t,e)=>n(t,e),this.xt=new MutationObserver(this.gt)}observe(n,t){this.xt.observe(n,t)}disconnect(n){this.xt.disconnect(),n&&n()}},t.A={attributes:!0,subtree:!0,attributeFilter:["class"],attributeOldValue:!0}},796:(n,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.X=void 0;t.X=class{constructor(n){this.gt=n}start(n,t,e=!1){n.addEventListener(t,this.gt,e)}remove(n,t,e=!1){n.removeEventListener(t,this.gt,e)}}},818:function(n,t,e){var o=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function u(n){try{r(o.next(n))}catch(n){s(n)}}function c(n){try{r(o.throw(n))}catch(n){s(n)}}function r(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(u,c)}r((o=o.apply(n,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.hn=function(){return o(this,void 0,void 0,(function*(){const n=s.L.In?s.L.In:yield(0,i.B)("#dockLeft");s.L.jn||(yield(0,i.B)(".layout__dockl"));const t=s.L.$n;for(let e of[n,t]){let t=(0,u.it)(e===n?"L":"R"),o=(0,u.ut)(e===n?"L":"R");t&&o?null==e||e.classList.add("dock-layout-expanded"):null==e||e.classList.remove("dock-layout-expanded")}}))},t.C=function(){return o(this,void 0,void 0,(function*(){var n,t,e;if(s.h.p)return;const o=yield(0,u.ot)(),i=!(0,u.it)("B")&&(0,u.ut)("B");null===(n=s.L.toolbar)||void 0===n||n.nextElementSibling.classList.toggle("has-dockb",o),null===(t=s.L.toolbar)||void 0===t||t.nextElementSibling.classList.toggle("has-layout-dockb-float",i),null===(e=s.L.On)||void 0===e||e.classList.toggle("has-layout-dockb-float",i)}))},t.H=function(){var n,t;null===(n=s.L.toolbar)||void 0===n||n.nextElementSibling.classList.remove("has-dockb"),null===(t=s.L.toolbar)||void 0===t||t.nextElementSibling.classList.remove("has-layout-dockb-float")},t.N=function(){var n;null===(n=document.querySelector(".dock-layout-expanded"))||void 0===n||n.classList.remove("dock-layout-expanded")};const i=e(629),s=e(49),u=e(937)},832:function(n,t,e){var o=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function u(n){try{r(o.next(n))}catch(n){s(n)}}function c(n){try{r(o.throw(n))}catch(n){s(n)}}function r(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(u,c)}r((o=o.apply(n,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.i=function(){return o(this,void 0,void 0,(function*(){if(s||u)for(let n=0;n<document.styleSheets.length;n++){let t=document.styleSheets[n];try{for(let n=0;n<t.cssRules.length;n++){let e=t.cssRules[n];e.selectorText&&e.selectorText.includes("::-webkit-scrollbar")&&(e.style.width||e.style.height||e.style.backgroundColor)&&(c.push({styleSheet:t,kt:e.cssText}),t.deleteRule(n),n--)}}catch(n){}}}))},t.Y=function(){return o(this,void 0,void 0,(function*(){if(c)for(let n=0;n<c.length;n++){let t=c[n];t.styleSheet.insertRule(t.kt,t.styleSheet.cssRules.length)}}))};const i=e(49),{En:s,p:u}=i.h,c=[]},844:function(n,t,e){var o=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function u(n){try{r(o.next(n))}catch(n){s(n)}}function c(n){try{r(o.throw(n))}catch(n){s(n)}}function r(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(u,c)}r((o=o.apply(n,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.un=void 0,t.Mt=c,t.F=function(){document.querySelectorAll(".file-tree .has-focus").forEach((n=>n.classList.remove("has-focus")))};const i=e(629),s=e(49),{p:u}=s.h;function c(){return o(this,void 0,void 0,(function*(){if(u)return;s.L.jn||(yield(0,i.B)(".layout__dockl"));let n=document.querySelectorAll(".file-tree .b3-list-item--focus");n.length&&(document.querySelectorAll(".file-tree .has-focus").forEach((n=>n.classList.remove("has-focus"))),n.forEach((n=>{n.nextElementSibling&&"UL"===n.nextElementSibling.tagName&&!n.nextElementSibling.classList.contains("fn__none")||n.parentNode instanceof Element&&n.parentNode.classList.add("has-focus")})))}))}t.un=(0,i.yn)(c)},863:function(n,t,e){var o=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function u(n){try{r(o.next(n))}catch(n){s(n)}}function c(n){try{r(o.throw(n))}catch(n){s(n)}}function r(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(u,c)}r((o=o.apply(n,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t._=function(n){return o(this,void 0,void 0,(function*(){let t=yield(0,i.wt)(n);const e=s.L.status||(yield(0,i.B)("#status"));e&&e.classList.toggle("asri--non-protyle-status",!t)}))},t.V=function(){const n=s.L.status;if(!n)return;n.classList.remove("asri--non-protyle-status")};const i=e(629),s=e(49)},937:function(n,t,e){var o=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function u(n){try{r(o.next(n))}catch(n){s(n)}}function c(n){try{r(o.throw(n))}catch(n){s(n)}}function r(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(u,c)}r((o=o.apply(n,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Cn=t.St=t.ln=void 0,t.kn=c,t.it=function(n){const t="B"===n?u.L.Bn:"L"===n?u.L.jn:u.L.Ln;return!(!t||t.classList.contains("layout--float"))},t.ut=function(n){const t="B"===n?u.L.Bn:"L"===n?u.L.jn:u.L.Ln;let e;if(!t)return!1;e="B"===n?t.style.height:t.style.width;return!(!e||"0px"===e)},t.st=function(n="L"){const t="B"===n?u.L.On:"L"===n?u.L.In:u.L.$n;return!(!t||!t.classList.contains("fn__none"))},t.ot=function(){return o(this,void 0,void 0,(function*(){return u.L.On||(yield(0,s.B)(".layout__dockb")),!(!u.L.On||u.L.On.classList.contains("fn__none"))}))},t.isFullScreen=function(){return!(!i.remote||!i.remote.getCurrentWindow().isFullScreen())},t.et=function(){return!(!u.L.status||!u.L.status.classList.contains("fn__none"))},t.k=function(){return o(this,void 0,void 0,(function*(){return yield(0,s.ht)('.layout__center [data-type="wnd"]').then((n=>{t.Cn=n})),t.Cn}))};const i=e(571),s=e(629),u=e(49);function c(){var n,e;u.L.toolbar&&(t.ln=(null===(n=u.L.toolbar)||void 0===n?void 0:n.scrollWidth)>u.L.toolbar.clientWidth,(null===(e=u.L.Vn)||void 0===e?void 0:e.classList.contains("fn__none"))||(t.ln=!0))}t.ln=!1,t.St=(0,s.yn)(c),t.Cn=document.querySelectorAll('.layout__center [data-type="wnd"]')}},t={};function e(o){var i=t[o];if(void 0!==i)return i.exports;var s=t[o]={exports:{}};return n[o].call(s.exports,s,s.exports,e),s.exports}(()=>{const n=e(2);(0,n.t)(),window.destroyTheme=()=>{let t=!0;setTimeout((()=>{const e=window.siyuan.config.appearance.themeLight,o=window.siyuan.config.appearance.themeDark;"Asri"===e&&"Asri"===o&&(t=!1),(0,n.T)(t)}),0)}})()})();